Versão funcionando, infelizmente não final
